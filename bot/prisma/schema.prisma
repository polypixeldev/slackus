generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model App {
  id   String @id @default(cuid())
  user String
  bot  String

  method Method?

  interval      Int
  conversations String
  checks        Check[]
}

model Method {
  id   String     @id @default(cuid())
  type MethodType

  command   CommandMethod?
  http      HttpMethod?

  appId String @unique
  app   App    @relation(fields: [appId], references: [id])
}

model CommandMethod {
  id      String @id @default(cuid())
  command String

  methodId String @unique
  method   Method @relation(fields: [methodId], references: [id])
}

model HttpMethod {
  id         String @id @default(cuid())
  url        String
  httpMethod String

  methodId String @unique
  method   Method @relation(fields: [methodId], references: [id])
}

enum MethodType {
  Command
  HTTP
  Heartbeat
}

model Check {
  id        String   @id @default(cuid())
  app       App      @relation(fields: [appId], references: [id])
  appId     String
  status    String   @default("up")
  timestamp DateTime
}
